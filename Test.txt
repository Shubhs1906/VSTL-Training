package com.scripts.portfolio;

import java.lang.reflect.Method;

import org.testng.SkipException;
import org.testng.annotations.AfterClass;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;
import com.flows.LoginLogoutFlowByShubham;
import com.flows.PortfolioFlowByShubhamM;
import com.flows.commonFlows.CommonFlow;
import com.generic.BaseTest;
import com.pageFactory.LoginPageByShubham;

import ru.yandex.qatools.allure.annotations.Description;
import ru.yandex.qatools.allure.annotations.Title;

public class TCID_16_17_Test extends BaseTest {

	// Global variables
	private CommonFlow objCommonFlow;
	private LoginPageByShubham objLoginPageByShubham;
	private String testCaseID = "";
	private LoginLogoutFlowByShubham objLoginLogoutFlowByShubham;
	private PortfolioFlowByShubhamM objPortfolioFlowByShubhamM;
	
	
	// Initialize Flows
	public void initializeFlowsAndPages() {
		objCommonFlow = new CommonFlow(this);
		objLoginPageByShubham = new LoginPageByShubham(this);
		objLoginLogoutFlowByShubham = new LoginLogoutFlowByShubham(this);
		objPortfolioFlowByShubhamM = new PortfolioFlowByShubhamM(this);
		
	}

	@BeforeClass(groups = { "P1", "P2", "P3" })
	public void initializeEnvironment() {
		this.initializeWebEnvironment("excel/MRS");
		this.initializeFlowsAndPages();
		/* Resource Name has to be before login */
		objCommonFlow.setResourceName("Khushbu Borole");
		// objLoginLogoutFlow.doLogin();
	}

	@AfterClass(groups = { "P1", "P2", "P3" })
	public void tearDownEnvironment() {
		this.tearDownWebEnvironment();
		objCommonFlow = null;
		objLoginPageByShubham = null;

	}

	@BeforeMethod(groups = { "P1", "P2", "P3" })
	public void redirect_Me_To_HomePage_On_SH_Application(Method method) {
		testCaseID = method.getName();
		this.startTestExecutionVideoRecording(testCaseID);
		this.getObjWrapperFunctions().waitFor(5);
		System.out.println("Video Recording Started ....!!");
	}

	@AfterMethod
	public void stopVideoRecording() {
		this.stopTestExecutionVideoRecording();
		this.getObjWrapperFunctions().waitFor(5);
		System.out.println("Video Recording Stopped ....!!");
	}
	
	@Title("TCID_16_OpenPlanInSOTViewWithDifferentYearVersions")
	@Description("Open folder in portfolio")
	@Test(priority = 1, groups = { "P1" },enabled=true)
	public void TCID_16_OpenPlanInSOTViewWithDifferentYearVersions() {
		this.loadTestData("TCID_16_OpenPlanInSOTViewWithDifferentYearVersions");
		if (!this.getObjUtilities().dpString("runmode").equals("Y")) {
			throw new SkipException("Run Mode 'No'");
		}
		objCommonFlow.openAUT_URL();
		objLoginLogoutFlowByShubham.doLoginWithExcelParameter();
		objPortfolioFlowByShubhamM.openProductInSOTViewWithVersion2020();
		objPortfolioFlowByShubhamM.openProductInSOTViewWithVersion2021();
		objPortfolioFlowByShubhamM.openProductInSOTViewWithVersion2022();
	}
	
	@Title("TCID_17_EditAndSavePlanInSOTView")
	@Description("Open folder in portfolio")
	@Test(priority = 1, groups = { "P1" })
	public void TCID_17_EditAndSavePlanInSOTView() {
		this.loadTestData("TCID_17_EditAndSavePlanInSOTView");
		if (!this.getObjUtilities().dpString("runmode").equals("Y")) {
			throw new SkipException("Run Mode 'No'");
		}
		objCommonFlow.openAUT_URL();
		objLoginLogoutFlowByShubham.doLoginWithExcelParameter();
		objPortfolioFlowByShubhamM.editAndSavePlanInSOTView();
		
	}
	
	

}
